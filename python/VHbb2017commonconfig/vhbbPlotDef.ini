# ------------------------------------------------------------------------------------------------------------------------------------------------------
# general vars
# ------------------------------------------------------------------------------------------------------------------------------------------------------
[plotDef:run]
relPath = run
xAxis = run
nBins = 1000
min = 294500
max = 306500

[plotDef:count]
xAxis = isData
relPath = isData
nBins = 2
min = -0.5
max = 1.5
drawOption = HIST;TEXT0
drawOptionData = PE;TEXT0

[plotDef:runEra]
xAxis = run era
relPath = -100*!isData-1+1*(run>=297020&&run<=299329)+2*(run>=299337&&run<=302029)+3*(run>=302030&&run<=303434)+4*(run>=303435&&run<=304826)+5*(run>=304911&&run<=306462)+6*(run>=306464&&run<=306826)+7*(run>=306828&&run<=307082)+8*(run>=306828&&run<=307082)+9*(run>307082)
#specialweight=(run>=297020&&run<=299329)/4.792+(run>=299337&&run<=302029)/9.755+(run>=302030&&run<=303434)/4.319+(run>=303435&&run<=304826)/9.424+(run>=304911&&run<=306462)/13.50+(run>=306464&&run<=306826)/0.14+(run>=306828&&run<=307082)/0.24
nBins = 10
min = -1
max = 9
drawOptionData = PE;TEXT0

[plotDef:isBoosted]
xAxis = isBoosted
relPath = isBoosted
nBins = 2
min = -0.5
max = 1.5
drawOption = HIST;TEXT0
drawOptionData = PE;TEXT0


[plotDef:countNoWeight]
relPath = 1 
xAxis   = count (no weight)
nBins   = 3
min     = 0
max     = 3
weight  = 1

[plotDef:countGenWeight]
relPath = 1 
xAxis   = count (gen-weight only)
nBins   = 3
min     = 0
max     = 3
weight  = genWeight

[plotDef:Vtype]
xAxis = Vtype
relPath = Vtype
nBins = 7
min = -1.5
max = 5.5

[plotDef:LeptonSelection]
xAxis = isZmm/isZee/isWmunu/isWenu/isZnn
relPath = -1 + isZmm + 2*isZee + 3*isWmunu + 4*isWenu + 5*isZnn
nBins = 5
min = 0
max = 5

[plotDef:parity]
relPath = event%%2
xAxis   = parity
nBins   = 2
min     = 0.0
max     = 2.0

# MC is split into even/odd events for training and inference
# for variables containing 'BDT' or 'DNN' in the expression, parity cuts are applied (even if this term is multiplied with zero)
[plotDef:parityBDTDNN]
relPath = event%%2 + 0.0 * (<!plotDef:DNN|relPath!>) 
xAxis   = parity (BDT/DNN)
nBins   = 2
min     = 0.0
max     = 2.0

# ------------------------------------------------------------------------------------------------------------------------------------------------------
# Generator variables
# ------------------------------------------------------------------------------------------------------------------------------------------------------
[plotDef:LHE_Nb]
xAxis = LHE_Nb 
relPath = LHE_Nb
nBins = 5
min = 0
max = 5
drawOption = HIST;TEXT0

[plotDef:LHE_HT]
relPath = LHE_HT
xAxis   = LHE_HT
nBins   = 100
min     = 0
max     = 2000
log     = True

[plotDef:LHE_Vpt]
relPath = LHE_Vpt
xAxis   = LHE_Vpt
nBins   = 80
min     = 0
max     = 800
log     = True

[plotDef:NGenJets20]
xAxis = Gen Jet Multiplicity (p_{T} > 20 GeV)
relPath = Sum$(GenJet_pt>20 && abs(GenJet_eta)<2.4)
nBins = 10
min = -0.5
max = 9.5

[plotDef:BmesonFromPS]
xAxis = Sum$(abs(GenPart_pdgId)>=500 && abs(GenPart_pdgId)<600 && GenPart_status==2)
relPath = Sum$(abs(GenPart_pdgId)>=500 && abs(GenPart_pdgId)<600 && GenPart_status==2)
nBins = 10
min = 0
max = 10
drawOption = HIST;TEXT0

[plotDef:BbaryonFromPS]
xAxis = Sum$(abs(GenPart_pdgId)>=5000 && abs(GenPart_pdgId)<6000 && GenPart_status==2)
relPath = Sum$(abs(GenPart_pdgId)>=5000 && abs(GenPart_pdgId)<6000 && GenPart_status==2)
nBins = 10
min = 0
max = 10
drawOption = HIST;TEXT0


[plotDef:ZJphaseSpace]
xAxis = light/PS/ME 100-200, light/PS/ME 200+  
relPath = 0*(LHE_Nb==0&&nGenStatus2bHad==0&&LHE_Vpt>100&&LHE_Vpt<200)+1*((LHE_Nb==0&&nGenStatus2bHad>0&&LHE_Vpt>100&&LHE_Vpt<200))+2*(LHE_Nb>0&&LHE_Vpt>100&&LHE_Vpt<200)+3*(LHE_Nb==0&&nGenStatus2bHad==0&&LHE_Vpt>200)+4*((LHE_Nb==0&&nGenStatus2bHad>0&&LHE_Vpt>200))+5*(LHE_Nb>0&&LHE_Vpt>200)
nBins = 6
min = 0
max = 6
drawOption = HIST;TEXT0

[plotDef:ZJphaseSpace2]
xAxis = 0=light, 1=b from PS 2=b from ME
relPath = 0*(LHE_Nb==0&&nGenStatus2bHad==0)+1*((LHE_Nb==0&&nGenStatus2bHad>0))+2*(LHE_Nb>0)
nBins = 3
min = 0
max = 3
drawOption = HIST;TEXT0

[plotDef:genEtabb]
xAxis = gen. #Delta #eta(b_{0}b_{1})
relPath =  abs(GenJet_eta[Jet_mcIdx[<!General|btagidx0!>]]-GenJet_eta[Jet_mcIdx[<!General|btagidx1!>]])
nBins = 32
min = 0.00001
max = 5

[plotDef:genEtabbPtJ]
xAxis = gen. #Delta #eta(b_{0}b_{1})
relPath =  abs(GenJet_eta[Jet_mcIdx[0]]-GenJet_eta[Jet_mcIdx[1]])
nBins = 32
min = 0.00001
max = 5

# ------------------------------------------------------------------------------------------------------------------------------------------------------
# jets 
# ------------------------------------------------------------------------------------------------------------------------------------------------------
[plotDef:HT30]
relPath = Sum$(Jet_Pt * (Jet_Pt>30))
xAxis   = HT [GeV] (jets > 30 GeV)
nBins   = 75
min     = 0
max     = 1500

[plotDef:Hj0_id]
relPath = Jet_jetId[<!General|btagidx0!>]
xAxis = leading jet Id
nBins = 16
min = 0
max = 16

[plotDef:Hj1_id]
relPath = Jet_jetId[<!General|btagidx1!>]
xAxis = second jet Id
nBins = 16
min = 0
max = 16

[plotDef:Hj0_PUid]
relPath = Jet_puId[<!General|btagidx0!>]
xAxis = leading jet PU Id
nBins = 8
min = 0
max = 8

[plotDef:Hj1_PUid]
relPath = Jet_puId[<!General|btagidx1!>]
xAxis = second jet PU Id
nBins = 8
min = 0
max = 8

[plotDef:Hj0_PUid_passTight]
relPath = Jet_puId[<!General|btagidx0!>]>6||Jet_Pt[<!General|btagidx0!>]>50
xAxis = leading jet tight PU Id pass 
nBins = 2
min = 0
max = 2

[plotDef:Hj1_PUid_passTight]
relPath = Jet_puId[<!General|btagidx1!>]>6||Jet_Pt[<!General|btagidx1!>]>50
xAxis = second jet tight PU Id pass
nBins = 2
min = 0
max = 2

[plotDef:Hj_higherBtagIsHarder]
relPath = (Jet_PtReg[<!General|btagidx0!>]>Jet_PtReg[<!General|btagidx1!>])
nBins = 2
min = 0
max = 2

[plotDef:Hj0_mass_reg]
relPath = Jet_mass[<!General|btagidx0!>]*Jet_PtReg[<!General|btagidx0!>]/Jet_Pt[<!General|btagidx0!>]
xAxis = leading reg. jet mass [GeV]
nBins = 50
min = 0
max = 50

[plotDef:Hj0_pt_reg]
relPath = Jet_PtReg[<!General|btagidx0!>]
xAxis = leading reg. jet p_{T} [GeV]
nBins = 25
min = 0
max = 400

[plotDef:Hj0_pt_reg_down]
relPath = Jet_PtRegDown[<!General|btagidx0!>]
xAxis = leading reg. jet p_{T} [GeV] down
nBins = 25
min = 0
max = 400

[plotDef:Hj0_pt_reg_up]
relPath = Jet_PtRegUp[<!General|btagidx0!>]
xAxis = leading reg. jet p_{T} [GeV] up
nBins = 25
min = 0
max = 400

[plotDef:Hj1_pt_reg]
relPath = Jet_PtReg[<!General|btagidx1!>]
xAxis = second reg. jet p_{T} [GeV]
nBins = 25
min = 0
max = 250

[plotDef:Hj0_pt]
relPath = Jet_Pt[<!General|btagidx0!>]
xAxis = leading jet p_{T} [GeV]
nBins = 25
min = 0
max = 400

[plotDef:Hj0_eta]
relPath = Jet_eta[<!General|btagidx0!>]
xAxis = leading jet #eta 
nBins = 60
min = -3
max = 3

[plotDef:Hj1_eta]
relPath = Jet_eta[<!General|btagidx1!>]
xAxis = second jet #eta 
nBins = 60
min = -3
max = 3


[plotDef:Hj0_phi]
relPath = Jet_phi[<!General|btagidx0!>]
xAxis = leading jet phi
nBins = 25
min = -3.15
max = 3.15

[plotDef:Hj0_pt250]
relPath = Jet_Pt[<!General|btagidx0!>]
xAxis = leading jet p_{T} [GeV]
nBins = 25
min = 0
max = 250

[plotDef:Hj1_pt]
relPath = Jet_Pt[<!General|btagidx1!>]
xAxis = second jet p_{T} [GeV]
nBins = 25
min = 0
max = 250

[plotDef:Hj1_phi]
relPath = Jet_phi[<!General|btagidx1!>]
xAxis = subleading jet phi
nBins = 25
min = -3.15
max = 3.15

[plotDef:min_pt_reg]
relPath = min(Jet_PtReg[<!General|btagidx0!>],Jet_PtReg[<!General|btagidx1!>])
xAxis = min jet p_{T} [GeV]
nBins = 25
min = 0
max = 250

[plotDef:max_pt]
relPath = max(Jet_Pt[<!General|btagidx0!>],Jet_Pt[<!General|btagidx1!>])
xAxis = max jet p_{T} [GeV]
nBins = 40
min = 0
max = 400

[plotDef:max_pt_reg]
relPath = max(Jet_PtReg[<!General|btagidx0!>],Jet_PtReg[<!General|btagidx1!>])
xAxis = max jet p_{T} [GeV] (reg)
nBins = 40
min = 0
max = 400

[plotDef:min_pt]
relPath = min(Jet_Pt[<!General|btagidx0!>],Jet_Pt[<!General|btagidx1!>])
xAxis = min jet p_{T} [GeV]
nBins = 25
min = 0
max = 250

[plotDef:max_pt_fsr]
relPath = -99+(hJidx[0]>-1)*(99+max(hJets_0_pt_FSRrecovered,hJets_1_pt_FSRrecovered))
xAxis = max jet p_{T} [GeV] incl. FSR
nBins = 35
min = 0
max = 350

[plotDef:max_pt_fsr_down]
relPath = isData*(<!plotDef:max_pt_fsr|relPath!>)+MinIf$((1-isData)*<!.|relPath_var!>,!isData)
relPath_var = -99+(hJidx[0]>-1)*(99+max(hJets_0_pt_FSRrecovered_jerReg_Down,hJets_1_pt_FSRrecovered_jerReg_Down))
xAxis = max jet p_{T} [GeV] incl. FSR
nBins = 35
min = 0
max = 350

[plotDef:max_pt_fsr_up]
relPath = isData*(<!plotDef:max_pt_fsr|relPath!>)+(1-isData)*<!.|relPath_var!>
relPath_var = -99+(hJidx[0]>-1)*(99+max(hJets_0_pt_FSRrecovered_jerReg_Up,hJets_1_pt_FSRrecovered_jerReg_Up))
xAxis = max jet p_{T} [GeV] incl. FSR
nBins = 35
min = 0
max = 350

[plotDef:min_pt_fsr]
relPath = -99+(hJidx[0]>-1)*(99+min(hJets_0_pt_FSRrecovered,hJets_1_pt_FSRrecovered))
xAxis = min jet p_{T} [GeV] incl. FSR
nBins = 20
min = 0
max = 200


[plotDef:Hj0_DeepCSV]
xAxis = max DeepCSV
relPath =  Jet_btagDeepB[<!General|btagidx0!>]
nBins = 25
min = 0
max = 1

[plotDef:Hj1_DeepCSV]
xAxis = min DeepCSV
relPath =  Jet_btagDeepB[<!General|btagidx1!>]
nBins = 25
min = 0
max = 1

[plotDef:Hj0_btag]
xAxis = max <!General|btagMethod!>
relPath = <!General|Jet_btag!>[<!General|btagidx0!>]
nBins = 25
min = 0
max = 1

[plotDef:FatJet_Pt]
relPath = FatJet_Pt[Hbb_fjidx]
xAxis = FatJet p_{T} [GeV]
nBins = 50
min = 0
max = 800

[plotDef:FatJet_mSD]
relPath = FatJet_Msoftdrop[Hbb_fjidx]
xAxis   = FatJet mSD  [GeV]
nBins   = 50
min     = 0
max     = 300

[plotDef:DeepAK8_bbVSlight]
relPath = FatJet_deepTagMD_bbvsLight[Hbb_fjidx]
xAxis   = Deep AK8 - bb vs light
nBins   = 20
min     = 0
max     = 1



[plotDef:Hj1_btag]
xAxis = min <!General|btagMethod!>
relPath = <!General|Jet_btag!>[<!General|btagidx1!>]
nBins = 25
min = 0
max = 1

[plotDef:Hj0_btag_WP]
xAxis = max <!General|btagMethod!>
relPath = (<!General|Jet_btag!>[<!General|btagidx0!>]><!General|btagWP_Tight!>)+(<!General|Jet_btag!>[<!General|btagidx0!>]><!General|btagWP_Medium!>)+(<!General|Jet_btag!>[<!General|btagidx0!>]><!General|btagWP_Loose!>) 
nBins = 4
min = -0.5
max = 3.5

[plotDef:Hj1_btag_WP]
xAxis = min <!General|btagMethod!>
relPath = (<!General|Jet_btag!>[<!General|btagidx1!>]><!General|btagWP_Tight!>)+(<!General|Jet_btag!>[<!General|btagidx1!>]><!General|btagWP_Medium!>)+(<!General|Jet_btag!>[<!General|btagidx1!>]><!General|btagWP_Loose!>) 
nBins = 4
min = -0.5
max = 3.5


[plotDef:Hj0_DeepCSVzoom]
xAxis = max DeepCSV
relPath =  Jet_btagDeepB[<!General|btagidx0!>]
nBins = 25
min = 0.9
max = 1

[plotDef:Hj1_DeepCSVzoom]
xAxis = min DeepCSV
relPath =  Jet_btagDeepB[<!General|btagidx1!>]
nBins = 25
min = 0.9
max = 1

[plotDef:Hj0_DeepCSV_WP]
xAxis = max DeepCSV WP
relPath = (Jet_btagDeepB[<!General|btagidx0!>]>0.1522)+(Jet_btagDeepB[<!General|btagidx0!>]>0.4941)+(Jet_btagDeepB[<!General|btagidx0!>]>0.8001)
nBins = 4
min = -0.5
max = 3.5

[plotDef:Hj1_DeepCSV_WP]
xAxis = min DeepCSV WP
relPath = (Jet_btagDeepB[<!General|btagidx1!>]>0.1522)+(Jet_btagDeepB[<!General|btagidx1!>]>0.4941)+(Jet_btagDeepB[<!General|btagidx1!>]>0.8001)
nBins = 4
min = -0.5
max = 3.5

[plotDef:Hj0_DeepJet]
xAxis = max DeepJet
relPath = Jet_btagDeepFlavB[<!General|btagidx0!>]
nBins = 25
min = 0
max = 1


[plotDef:Hj1_DeepJet]
xAxis = min DeepJet
relPath = Jet_btagDeepFlavB[<!General|btagidx1!>]
nBins = 25
min = 0
max = 1


[plotDef:deltaRbb]
relPath = VHbb::deltaR( Jet_eta[<!General|btagidx0!>], Jet_phi[<!General|btagidx0!>], Jet_eta[<!General|btagidx1!>], Jet_phi[<!General|btagidx1!>])
xAxis   = #Delta R(bb)
nBins   = 30 
min     = 0
max     = 6 

[plotDef:deltaRbbWithFSR]
relPath = TMath::Sqrt(hJets_FSRrecovered_dEta*hJets_FSRrecovered_dEta+hJets_FSRrecovered_dPhi*hJets_FSRrecovered_dPhi) 
xAxis   = #Delta R(bb) (w/ FSR recovery)
nBins   = 30 
min     = 0
max     = 6 

[plotDef:deltaEtabb]
relPath = abs(Jet_eta[<!General|btagidx0!>] - Jet_eta[<!General|btagidx1!>])
xAxis   = #Delta #eta(bb)
nBins   = 32
min     = 0
max     = 5

[plotDef:deltaEtabbWithFSR]
relPath = -99+(hJidx[0]>-1)*(99+hJets_FSRrecovered_dEta)
xAxis   = #Delta #eta(b_{0}b_{1}) (w/ FSR recovery)
nBins   = 32
min     = 0
max     = 5

[plotDef:deltaEtabbWithFSRnoNLOweight]
relPath = hJets_FSRrecovered_dEta 
xAxis   = #Delta #eta(b_{0}b_{1}) (w/ FSR recovery)
nBins   = 32
min     = 0
max     = 5
weight  = <!Weights|weightF!>/<!Weights|weightNLO!>
additionalText = "no NLO weight"

[plotDef:Etabb0b]
xAxis = 0 b-jets #Delta #eta(b_{0}b_{1})
relPath =  (Sum$(GenJet_pt>20 && abs(GenJet_eta)<2.4 && GenJet_numBHadrons>0)<1)*abs(Jet_eta[<!General|btagidx0!>] - Jet_eta[<!General|btagidx1!>]) + (!(Sum$(GenJet_pt>20 && abs(GenJet_eta)<2.4 && GenJet_numBHadrons>0)<1))*(-1)
nBins = 32
min = 0
max = 5
[plotDef:Etabb1b]
xAxis = 1 b-jets #Delta #eta(b_{0}b_{1})
relPath =  (Sum$(GenJet_pt>20 && abs(GenJet_eta)<2.4 && GenJet_numBHadrons>0)==1)*abs(Jet_eta[<!General|btagidx0!>] - Jet_eta[<!General|btagidx1!>]) + (!(Sum$(GenJet_pt>20 && abs(GenJet_eta)<2.4 && GenJet_numBHadrons>0)==1))*(-1)
nBins = 32
min = 0
max = 5
[plotDef:Etabb2b]
xAxis = 2 b-jets #Delta #eta(b_{0}b_{1})
relPath =  (Sum$(GenJet_pt>20 && abs(GenJet_eta)<2.4 && GenJet_numBHadrons>0)>=2)*abs(Jet_eta[<!General|btagidx0!>] - Jet_eta[<!General|btagidx1!>]) + (!(Sum$(GenJet_pt>20 && abs(GenJet_eta)<2.4 && GenJet_numBHadrons>0)>=2))*(-1)
nBins = 8
min = 0
max = 5

[plotDef:deltaPhibb]
xAxis = #Delta #phi(bb)
relPath = abs(VHbb::deltaPhi(Jet_phi[<!General|btagidx0!>],Jet_phi[<!General|btagidx1!>]))
nBins = 20
min = 0
max = 3.2

[plotDef:deltaPhibbWithFSR]
relPath = -99+(hJidx[0]>-1)*(99+hJets_FSRrecovered_dPhi)
xAxis   = #Delta #phi(bb) (w/ FSR recovery) 
nBins = 20
min = 0
max = 3.2

[plotDef:minDphiJetH]
relPath = MinIf$(abs(H_phi-Jet_phi),Jet_lepFilter&&Jet_Pt>30&&(Jet_puId>6||Jet_Pt>50)&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1])
xAxis   = min {#Delta #phi(j_{add}, H)}
nBins   = 32
min     = 0
max     = 3.2

[plotDef:jet0_trk_pt]
xAxis = Leading jet trk. p_{T}
relPath = Jet_leadTrackPt[<!General|btagidx0!>]
nBins = 25
min = 0
max = 400

[plotDef:jet1_trk_pt]
xAxis = Subleading jet trk. p_{T}
relPath = Jet_leadTrackPt[<!General|btagidx1!>]
nBins = 25
min = 0
max = 400

[plotDef:jet0_vtxMass]
xAxis = Leading jet vtx mass
relPath = Jet_vtxMass[<!General|btagidx0!>]
nBins = 12
min = 0
max = 6

[plotDef:jet1_vtxMass]
xAxis = Subleading jet vtx mass
relPath = Jet_vtxMass[<!General|btagidx1!>]
nBins = 12
min = 0
max = 6

[plotDef:jet0_vtxpt]
xAxis = Leading jet vtx p_{T}
relPath = Jet_vtxPt[<!General|btagidx0!>]
nBins = 15
min = 0
max = 300

[plotDef:jet1_vtxpt]
xAxis = Subleading jet vtx p_{T}
relPath = Jet_vtxPt[<!General|btagidx1!>]
nBins = 15
min = 0
max = 300

[plotDef:jet0_neEmEF]
xAxis = Leading jet neut. frac. Had
relPath = Jet_neEmEF[<!General|btagidx0!>]
nBins = 25
min = 0
max = 1

[plotDef:jet1_neEmEF]
xAxis = Subleading jet neut. frac. Had
relPath = Jet_neEmEF[<!General|btagidx1!>]
nBins = 25
min = 0
max = 1

[plotDef:jet0_neEmEF]
xAxis = Leading jet neut+ch frac. Em
relPath = Jet_chHEF[<!General|btagidx0!>]+Jet_neHEF[<!General|btagidx0!>]
nBins = 25
min = 0
max = 1

[plotDef:jet1_neEmEF]
xAxis = Subleading jet neut+ch frac. Em
relPath = Jet_chHEF[<!General|btagidx1!>]+Jet_neHEF[<!General|btagidx1!>]
nBins = 25
min = 0
max = 1

[plotDef:jet0_lepPtRel]
xAxis = Leading jet lep. p_{T} rel.
relPath = Jet_leptonPtRel[<!General|btagidx0!>]
nBins = 20
min = 0
max = 20

[plotDef:jet1_lepPtRel]
xAxis = Suleading jet lep. p_{T} rel.
relPath = Jet_leptonPtRel[<!General|btagidx1!>]
nBins = 20
min = 0
max = 20

[plotDef:jet0_lepPt]
xAxis = Leading jet lep. p_{T}
relPath = Jet_leptonPt[<!General|btagidx0!>]
nBins = 20
min = 0
max = 20

[plotDef:jet1_lepPt]
xAxis = Subleading jet lep. p_{T}
relPath = Jet_leptonPt[<!General|btagidx1!>]
nBins = 20
min = 0
max = 20

[plotDef:jet0_deltaR]
xAxis = Leading jet lep. #Delta R
relPath = Jet_leptonDeltaR[<!General|btagidx0!>]
nBins = 20
min = 0
max = 0.4

[plotDef:jet1_deltaR]
xAxis = Leading jet lep. #Delta R
relPath = Jet_leptonDeltaR[<!General|btagidx1!>]
nBins = 20
min = 0
max = 0.4

# ------------------------------------------------------------------------------------------------------------------------------------------------------
# leptons 
# ------------------------------------------------------------------------------------------------------------------------------------------------------

[plotDef:deltaRmm]
relPath = VHbb::deltaR( Muon_eta[vLidx[0]], Muon_phi[vLidx[0]], Muon_eta[vLidx[1]], Muon_phi[vLidx[1]])*(-1.0+2.0*(Vtype==0||Vtype==2))
xAxis = #Delta R (#mu#mu)
nBins = 40
min = 0
max = 6
weight = (<!Weights|weightF!>)

[plotDef:deltaRee]
relPath = VHbb::deltaR( Electron_eta[vLidx[0]], Electron_phi[vLidx[0]], Electron_eta[vLidx[1]], Electron_phi[vLidx[1]])*(-1.0+2.0*(Vtype==1||Vtype==3))
xAxis = #Delta R (ee)
nBins = 40
min = 0
max = 6
weight = (<!Weights|weightF!>)

[plotDef:deltaPhimm]
relPath = abs(VHbb::deltaPhi( Muon_phi[vLidx[0]], Muon_phi[vLidx[1]]))*(-1.0+2.0*(Vtype==0||Vtype==2))
xAxis   = #Delta #phi(#mu#mu) 
nBins   = 40
min     = 0
max     = 3.1416
weight  = (<!Weights|weightF!>)

[plotDef:deltaPhiee]
relPath = abs(VHbb::deltaPhi( Electron_phi[vLidx[0]], Electron_phi[vLidx[1]]))*(-1.0+2.0*(Vtype==1||Vtype==3))
xAxis   = #Delta #phi(ee)
nBins   = 40
min     = 0
max     = 3.1416
weight  = (<!Weights|weightF!>)

[plotDef:deltaEtamm]
relPath = abs(Muon_eta[vLidx[0]] - Muon_eta[vLidx[1]])*(-1.0+2.0*(Vtype==0||Vtype==2))
xAxis   = #Delta #eta(#mu#mu) 
nBins   = 40
min     = 0
max     = 6
weight  = (<!Weights|weightF!>)

[plotDef:deltaEtaee]
relPath = abs(Electron_eta[vLidx[0]] - Electron_eta[vLidx[1]])*(-1.0+2.0*(Vtype==1||Vtype==3))
xAxis   = #Delta #eta(ee)
nBins   = 40
min     = 0
max     = 6
weight  = (<!Weights|weightF!>)

[plotDef:Electron_pfRelIso03_all_0]
relPath = Electron_pfRelIso03_all[vLidx[0]]*(-1.0+2.0*(Vtype==1||Vtype==3))
xAxis = ele iso
nBins = 40
min   = 0
max   = 0.1

[plotDef:Electron_pfRelIso03_all_0_ext]
relPath = Electron_pfRelIso03_all[vLidx[0]]*(-1.0+2.0*(Vtype==1||Vtype==3))
xAxis = ele iso
nBins = 100
min   = 0
max   = 1.0

[plotDef:Electron_mvaTTH_0]
relPath = Electron_mvaTTH[vLidx[0]]*(-1.0+2.0*(Vtype==1||Vtype==3))
xAxis = electron TTH MVA ID
nBins = 40
min = -1
max = 1
log = True


[plotDef:e0pt]
xAxis = leading electron p_{T}
relPath = Electron_pt[vLidx[0]]*(-1.0+2.0*(Vtype==1||Vtype==3))
nBins = 40
min = 0
max = 400
weight  = (<!Weights|weightF!>)

[plotDef:e0phi]
xAxis = leading electron phi
relPath = Electron_phi[vLidx[0]]*(-1.0+2.0*(Vtype==1||Vtype==3))
nBins = 31
min = -3.1416
max = 3.1416
weight  = (<!Weights|weightF!>)

[plotDef:e0metdphi]
xAxis = d phi e MET
relPath = abs(TVector2::Phi_mpi_pi(MET_Phi-Electron_phi[vLidx[0]]))*(-1.0+2.0*(Vtype==1||Vtype==3))
nBins = 31
min = 0 
max = 3.1416
weight  = (<!Weights|weightF!>)

[plotDef:e0metdphi_uncorr]
xAxis = d phi e MET (no XY) 
relPath = abs(TVector2::Phi_mpi_pi(MET_Phi_uncorrected-Electron_phi[vLidx[0]]))*(-1.0+2.0*(Vtype==1||Vtype==3))
nBins = 31
min = 0 
max = 3.1416
weight  = (<!Weights|weightF!>)

[plotDef:e0eta]
xAxis = leading electron #eta 
relPath = Electron_eta[vLidx[0]]*(-99.0+100.0*(Vtype==1||Vtype==3))
nBins = 80
min = -4
max = 4
weight  = (<!Weights|weightF!>)

[plotDef:e1eta]
xAxis = subleading electron #eta 
relPath = Electron_eta[vLidx[1]]*(-99.0+100.0*(Vtype==1))
nBins = 80
min = -4
max = 4
weight  = (<!Weights|weightF!>)


[plotDef:e1pt]
xAxis = subleading electron p_{T}
relPath = Electron_pt[vLidx[1]]*(-1.0+2.0*(Vtype==1))
nBins = 40
min = 0
max = 400
weight  = (<!Weights|weightF!>)

[plotDef:Muon_pfRelIso04_all_0]
relPath = Muon_pfRelIso04_all[vLidx[0]]*(-1.0+2.0*(Vtype==0||Vtype==2))
xAxis = muon iso
nBins = 20
min = 0
max = 0.1

[plotDef:Muon_pfRelIso04_all_0_ext]
relPath = Muon_pfRelIso04_all[vLidx[0]]*(-1.0+2.0*(Vtype==0||Vtype==2))
xAxis = muon iso
nBins = 100
min = 0
max = 1.0

[plotDef:Muon_mvaId_0]
relPath = Muon_mvaId[vLidx[0]]*(-1.0+2.0*(Vtype==0||Vtype==2))
xAxis = muon MVA ID
nBins = 4
min = 0
max = 4

#Muon_softMvaId[vLidx[0]]
[plotDef:Muon_softMvaId_0]
relPath = Muon_softMvaId[vLidx[0]]*(-1.0+2.0*(Vtype==0||Vtype==2))
xAxis = muon soft MVA ID
nBins = 40
min = -4
max = 4

[plotDef:Muon_mvaTTH_0]
relPath = Muon_mvaTTH[vLidx[0]]*(-1.0+2.0*(Vtype==0||Vtype==2))
xAxis = muon TTH MVA ID
nBins = 40
min = -1
max = 1
log = True

[plotDef:Muon_mvaTTH_0_sqrt]
relPath = TMath::Sqrt(Muon_mvaTTH[vLidx[0]]*(-1.0+2.0*(Vtype==0||Vtype==2)))
xAxis = muon TTH MVA ID
nBins = 50
min = -1
max = 1
log = True


[plotDef:m0pt]
xAxis = leading muon p_{T}
relPath = Muon_pt[vLidx[0]]*(-1.0+2.0*(Vtype==0||Vtype==2))
nBins = 40
min = 0
max = 400
weight  = (<!Weights|weightF!>)

[plotDef:Muon_pt0]
xAxis = leading muon p_{T}
relPath = Muon_pt[vLidx[0]]*(-1.0+2.0*(Vtype==0||Vtype==2))
nBins = 40
min = 0
max = 400
weight  = (<!Weights|weightF!>)

[plotDef:Muon_pt1]
xAxis = subleading muon p_{T}
relPath = Muon_pt[vLidx[1]]*(-1.0+2.0*(Vtype==0))
nBins = 40
min = 0
max = 400
weight  = (<!Weights|weightF!>)

[plotDef:Muon_corrected_pt0]
xAxis = leading muon p_{T}
relPath = Muon_corrected_pt[vLidx[0]]*(-1.0+2.0*(Vtype==0||Vtype==2))
nBins = 40
min = 0
max = 400
weight  = (<!Weights|weightF!>)

[plotDef:Muon_corrected_pt1]
xAxis = subleading muon p_{T}
relPath = Muon_corrected_pt[vLidx[1]]*(-1.0+2.0*(Vtype==0))
nBins = 40
min = 0
max = 400
weight  = (<!Weights|weightF!>)

[plotDef:m0eta]
xAxis = leading muon #eta 
relPath = Muon_eta[vLidx[0]]*(-99.0+100.0*(Vtype==0||Vtype==2))
nBins = 80
min = -4.0
max = 4.0
weight  = (<!Weights|weightF!>)

[plotDef:m1eta]
xAxis = subleading muon #eta 
relPath = Muon_eta[vLidx[1]]*(-99.0+100.0*(Vtype==0))
nBins = 80
min = -4.0
max = 4.0
weight  = (<!Weights|weightF!>)


[plotDef:m1pt]
xAxis = subleading muon p_{T}
relPath = Muon_pt[vLidx[1]]*(-1.0+2.0*(Vtype==0))
nBins = 40
min = 0
max = 400
weight  = (<!Weights|weightF!>)

[plotDef:vetoLeptons]
xAxis = n veto-leptons
relPath = (nVetoElectrons+nVetoMuons) 
nBins = 5
min = 0
max = 5

[plotDef:vetoElectrons]
xAxis = n veto-electrons
relPath = nVetoElectrons
nBins = 5
min = 0
max = 5

[plotDef:vetoMuons]
xAxis = n veto-muons
relPath = nVetoMuons
nBins = 5
min = 0
max = 5

[plotDef:deltaPhibe]
xAxis = #Delta #phi_{min}(b,leading electron)
relPath =  abs(min(VHbb::deltaPhi(Jet_eta[<!General|btagidx0!>],Electron_pt[vLidx[0]]),VHbb::deltaPhi(Jet_eta[<!General|btagidx1!>],Electron_pt[vLidx[0]])))
nBins = 20
min = 0
max = 3.2
weight = (<!Weights|weightF!>)*(Vtype==1||Vtype==3)

[plotDef:deltaPhibm]
xAxis = #Delta #phi_{min}(b,leading muon)
relPath =  abs(min(VHbb::deltaPhi(Jet_eta[<!General|btagidx0!>],Electron_pt[vLidx[0]]),VHbb::deltaPhi(Jet_eta[<!General|btagidx1!>],Electron_pt[vLidx[0]])))
nBins = 20
min = 0
max = 3.2
weight = (<!Weights|weightF!>)*(Vtype==0||Vtype==2)



# ------------------------------------------------------------------------------------------------------------------------------------------------------
# additional jets
# ------------------------------------------------------------------------------------------------------------------------------------------------------

[plotDef:nAddBJets302p5]
xAxis = add (L) b-tagged Jet Multiplicity (p_{T} > 30 GeV), eta < 2.5, jet ID
relPath = Sum$(Jet_Pt>30&&abs(Jet_eta)<2.5&&Jet_jetId>0&&Jet_lepFilter>0&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1]&&<!General|Jet_btag!>><!General|btagWP_Loose!>) 
nBins = 10
min = -0.5
max = 9.5

[plotDef:nAddJets302p5]
xAxis = add Jet Multiplicity (p_{T} > 30 GeV), eta < 2.5, jet ID
relPath = Sum$(Jet_Pt>30&&abs(Jet_eta)<2.5&&Jet_jetId>0&&Jet_lepFilter>0&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1]) 
nBins = 10
min = -0.5
max = 9.5

[plotDef:nAddJets302p5puid5]
xAxis = add Jet Multiplicity (p_{T} > 30 GeV), eta < 2.5, medium PU ID, jet ID
relPath = Sum$(Jet_Pt>30&&abs(Jet_eta)<2.5&&(Jet_puId>4||Jet_Pt>50)&&Jet_jetId>0&&Jet_lepFilter>0&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1]) 
nBins = 10
min = -0.5
max = 9.5

[plotDef:nAddJets302p5puid1]
xAxis = add Jet Multiplicity (p_{T} > 30 GeV), eta < 2.5, loose PU ID, jet ID
relPath = Sum$(Jet_Pt>30&&abs(Jet_eta)<2.5&&(Jet_puId>0||Jet_Pt>50)&&Jet_jetId>0&&Jet_lepFilter>0&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1]) 
nBins = 10
min = -0.5
max = 9.5


[plotDef:nAddJets302p5puid7]
xAxis = add Jet Multiplicity (p_{T} > 30 GeV), eta < 2.5, tight PU ID, jet ID
relPath = Sum$(Jet_Pt>30&&abs(Jet_eta)<2.5&&(Jet_puId>6||Jet_Pt>50)&&Jet_jetId>0&&Jet_lepFilter>0&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1]) 
nBins = 10
min = -0.5
max = 9.5

[plotDef:nAddJets302p5puid7noid]
xAxis = add Jet Multiplicity (p_{T} > 30 GeV), eta < 2.5, tight PU ID
relPath = Sum$(Jet_Pt>30&&abs(Jet_eta)<2.5&&(Jet_puId>6||Jet_Pt>50.0)&&Jet_lepFilter&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1]) 
nBins = 10
min = -0.5
max = 9.5

[plotDef:nAddJets302p5puid5noid]
xAxis = add Jet Multiplicity (p_{T} > 30 GeV), eta < 2.5, medium PU ID
relPath = Sum$(Jet_Pt>30&&abs(Jet_eta)<2.5&&(Jet_puId>4||Jet_Pt>50.0)&&Jet_lepFilter&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1]) 
nBins = 10
min = -0.5
max = 9.5

[plotDef:nAddJets302p5puid1noid]
xAxis = add Jet Multiplicity (p_{T} > 30 GeV), eta < 2.5, loose PU ID
relPath = Sum$(Jet_Pt>30&&abs(Jet_eta)<2.5&&(Jet_puId>0||Jet_Pt>50.0)&&Jet_lepFilter&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1]) 
nBins = 10
min = -0.5
max = 9.5

[plotDef:nAddJets302p4]
xAxis = add Jet Multiplicity (p_{T} > 30 GeV), eta < 2.4, jet ID
relPath = Sum$(Jet_Pt>30&&abs(Jet_eta)<2.4&&Jet_jetId>0&&Jet_lepFilter>0&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1]) 
nBins = 10
min = -0.5
max = 9.5

[plotDef:nAddJets302p4puid1]
xAxis = add Jet Multiplicity (p_{T} > 30 GeV), eta < 2.4, loose PU ID, jet ID
relPath = Sum$(Jet_Pt>30&&abs(Jet_eta)<2.4&&(Jet_puId>0||Jet_Pt>50)&&Jet_jetId>0&&Jet_lepFilter>0&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1]) 
nBins = 10
min = -0.5
max = 9.5

[plotDef:nAddJets302p4puid5]
xAxis = add Jet Multiplicity (p_{T} > 30 GeV), eta < 2.4, medium PU ID, jet ID
relPath = Sum$(Jet_Pt>30&&abs(Jet_eta)<2.4&&(Jet_puId>4||Jet_Pt>50)&&Jet_jetId>0&&Jet_lepFilter>0&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1]) 
nBins = 10
min = -0.5
max = 9.5


[plotDef:nAddJets302p4puid7]
xAxis = add Jet Multiplicity (p_{T} > 30 GeV), eta < 2.4, tight PU ID, jet ID
relPath = Sum$(Jet_Pt>30&&abs(Jet_eta)<2.4&&(Jet_puId>6||Jet_Pt>50)&&Jet_jetId>0&&Jet_lepFilter>0&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1]) 
nBins = 10
min = -0.5
max = 9.5

[plotDef:nAddJets302p4puid7noid]
xAxis = add Jet Multiplicity (p_{T} > 30 GeV), eta < 2.4, tight PU ID
relPath = Sum$(Jet_Pt>30&&abs(Jet_eta)<2.4&&(Jet_puId>6||Jet_Pt>50)&&Jet_lepFilter&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1]) 
nBins = 10
min = -0.5
max = 9.5


[plotDef:nAddJets302p4puid7_old]
xAxis = add Jet Multiplicity (p_{T} > 30 GeV)
relPath = Sum$(Jet_Pt>30&&abs(Jet_eta)<2.4&&Jet_puId==7&&Jet_jetId>0&&Jet_lepFilter>0&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1]) 
nBins = 10
min = -0.5
max = 9.5

[plotDef:nAddJets302p4puid7jetid4]
xAxis = add Jet Multiplicity (p_{T} > 30 GeV), eta < 2.4, tight PU ID, tight jet ID
relPath = Sum$(Jet_Pt>30&&abs(Jet_eta)<2.4&&(Jet_puId>6||Jet_Pt>50)&&Jet_jetId>4&&Jet_lepFilter&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1])
nBins = 10
min = -0.5
max = 9.5

[plotDef:nAddJets302p5puid7jetid4]
xAxis = add Jet Multiplicity (p_{T} > 30 GeV), eta < 2.4, tight PU ID, tight jet ID
relPath = Sum$(Jet_Pt>30&&abs(Jet_eta)<2.5&&(Jet_puId>6||Jet_Pt>50.0)&&Jet_jetId>4&&Jet_lepFilter&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1])
nBins = 10
min = -0.5
max = 9.5

[plotDef:nAddJets252p5puid7]
xAxis = add Jet Multiplicity (p_{T} > 25 GeV), eta < 2.5, tight PU ID, jet ID
relPath = Sum$(Jet_Pt>25&&abs(Jet_eta)<2.5&&(Jet_puId>6||Jet_Pt>50)&&Jet_jetId>0&&Jet_lepFilter>0&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1]) 
nBins = 10
min = -0.5
max = 9.5

[plotDef:nAddJets202p5puid7]
xAxis = add Jet Multiplicity (p_{T} > 20 GeV), eta < 2.5, tight PU ID, jet ID
relPath = Sum$(Jet_Pt>20&&abs(Jet_eta)<2.5&&(Jet_puId>6||Jet_Pt>50)&&Jet_jetId>0&&Jet_lepFilter>0&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1]) 
nBins = 10
min = -0.5
max = 9.5

[plotDef:SA10]
relPath = SA10 
xAxis = Soft Activity #Jets = 10
nBins = 10
min = -0.5
max = 9.5

[plotDef:SA2]
relPath = SA2
xAxis = Soft Activity #Jets = 2
nBins = 10
min = -0.5
max = 9.5

[plotDef:SA5]
relPath = SA5
xAxis = SA5 
nBins = 10
min = -0.5
max = 9.5

#SoftActivityJetNjets5
[plotDef:SoftActivityJetNjets5]
relPath = SoftActivityJetNjets5
xAxis = SoftActivityJetNjets5
nBins = 10
min = -0.5
max = 9.5


[plotDef:nAddJetsQCD]
relPath = Sum$(abs(TVector2::Phi_mpi_pi(Jet_phi-MET_Phi))<0.5&&Jet_Pt>30&&(Jet_puId>6||Jet_Pt>50)&&Jet_lepFilter&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1])
xAxis   = Add. Jet Multiplicity QCD
nBins   = 10
min     = 0
max     = 10

[plotDef:nAddJetsQCD20]
relPath = Sum$(abs(TVector2::Phi_mpi_pi(Jet_phi-MET_Phi))<0.5&&Jet_Pt>20&&(Jet_puId>6||Jet_Pt>50)&&Jet_lepFilter&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1])
xAxis   = Add. Jet Multiplicity QCD
nBins   = 10
min     = 0
max     = 10

[plotDef:bflav_test]
relPath = 2*(Sum$((((abs(GenPart_pdgId)/1000)%%10==5)||((abs(GenPart_pdgId)/100)%%10==5)) && GenPart_pt>25 && abs(GenPart_eta)<2.6 && GenPart_status==2&& (GenPart_statusFlags>>14)%%2==0 )>0)+(Sum$((((abs(GenPart_pdgId)/1000)%%10==5)||((abs(GenPart_pdgId)/100)%%10==5)) && GenPart_pt>25 && abs(GenPart_eta)<2.6 && GenPart_status==2 && (GenPart_statusFlags>>14)%%2==0)<1&&Sum$((((abs(GenPart_pdgId)/1000)%%10==4)||((abs(GenPart_pdgId)/100)%%10==4)) && GenPart_pt>25 && abs(GenPart_eta)<2.6 && GenPart_status==2 && (GenPart_statusFlags>>14)%%2==0)>0) 
xAxis = 0=udsg, 1=c, 2=b
nBins = 3
min = 0
max = 3

# ------------------------------------------------------------------------------------------------------------------------------------------------------
# MET
# ------------------------------------------------------------------------------------------------------------------------------------------------------
[plotDef:MET]
relPath = MET_Pt
xAxis   = MET p_{T} [GeV] (corrected & smeared)
nBins   = 40
min     = 0
max     = 400

[plotDef:METFixEE2017_pt]
relPath = METFixEE2017_pt
xAxis   = METFixEE2017_pt 
nBins   = 40
min     = 0
max     = 400

#MET_Pt_uncorrected
[plotDef:MET_uncorrected]
relPath = MET_Pt_uncorrected
xAxis   = MET p_{T} [GeV] (corrected (no XY) & smeared)
nBins   = 40
min     = 0
max     = 400

[plotDef:MET100to800]
relPath = MET_Pt
xAxis   = MET p_{T} [GeV] (corrected & smeared)
nBins   = 28
min     = 100
max     = 800

[plotDef:MET100to800noNLOweight]
relPath = MET_Pt
xAxis   = MET p_{T} [GeV] (corrected & smeared) no NLO weight
nBins   = 28
min     = 100
max     = 800
weight  = <!Weights|weightF!>/<!Weights|weightNLO!>

#(sampleIndex>=15000&&sampleIndex<16500)*

[plotDef:MET100to800NLOnorm]
relPath = MET_Pt
xAxis   = MET p_{T} [GeV] (corrected & smeared), NLO weight, NLO norm
nBins   = 28
min     = 100
max     = 800
weight  = <!Weights|weightF!>*(1.0+(sampleIndex>=15000&&sampleIndex<16500)*(-1.0+1.158))*(1.0+(sampleIndex>=4000&&sampleIndex<6000)*(-1.0+1.119))*(1.0+(sampleIndex>=11000&&sampleIndex<14300)*(-1.0+0.945))


[plotDef:rawMET]
relPath = MET_pt
xAxis   = MET p_{T} [GeV] (raw)
nBins   = 40
min     = 0
max     = 400

[plotDef:tkMET]
relPath = TkMET_pt
xAxis   = Tracker MET [GeV]
nBins   = 50
min     = 0
max     = 500

[plotDef:dPhi_MET_tkMET]
relPath = abs(TVector2::Phi_mpi_pi(MET_Phi-TkMET_phi))
xAxis   = #||{#Delta#Phi(MET, tkMET)}
nBins   = 36
min     = -0.3
max     = 3.3

[plotDef:dMetTkMet]
relPath = TMath::Sqrt((MET_Pt*TMath::Cos(MET_Phi)-TkMET_pt*TMath::Cos(TkMET_phi))**2+(MET_Pt*TMath::Sin(MET_Phi)-TkMET_pt*TMath::Sin(TkMET_phi))**2) 
xAxis = #||{MET - TkMET}
nBins = 50
min = 0
max = 500

[plotDef:dPhi_dMetTkMet_MET]
relPath = TVector2::Phi_mpi_pi(TMath::ATan2((MET_Pt*TMath::Sin(MET_Phi)-TkMET_pt*TMath::Sin(TkMET_phi)),(MET_Pt*TMath::Cos(MET_Phi)-TkMET_pt*TMath::Cos(TkMET_phi))))
xAxis = #phi(MET-TkMET)
nBins = 30
min = -3.1416
max = 3.1416

[plotDef:ratio_dMetTkMet_TkMET]
relPath = TMath::Sqrt((MET_Pt*TMath::Cos(MET_Phi)-TkMET_pt*TMath::Cos(TkMET_phi))**2+(MET_Pt*TMath::Sin(MET_Phi)-TkMET_pt*TMath::Sin(TkMET_phi))**2)/TkMET_pt
xAxis = #||{MET - TkMET} / TkMET
nBins = 50
min = 0
max = 2.5


[plotDef:ratio_MET_TkMET]
relPath = MET_Pt / TkMET_pt
xAxis = MET / TkMET
nBins = 60
min = 0
max = 6

[plotDef:ratio_d_TkMET_MET]
relPath = (MET_Pt - TkMET_pt)/TkMET_pt
xAxis = (MET_Pt - TkMET_pt)/TkMET_pt
nBins = 40
min = -0.5
max = 3.5

[plotDef:ratio_d_TkMET_MET_l]
relPath = (MET_Pt - TkMET_pt)/TkMET_pt
xAxis = (MET_Pt - TkMET_pt)/TkMET_pt
nBins = 80
min = -0.5
max = 7.5

[plotDef:ratio_d_TkMET_MET_sum]
relPath = (MET_Pt - TkMET_pt)/(TkMET_pt+MET_Pt)
xAxis = (MET_Pt - TkMET_pt)/(TkMET_pt+MET_Pt)
nBins = 40
min = -1.0
max = 1.0

[plotDef:TkMET_MET]
relPath = TkMET_pt:MET_Pt
xAxis = MET_Pt
yAxis = TkMET_pt
nBins = 30 
min = 0
max = 600
nBinsY = 30
minY = 0
maxY = 600
draw = DATA




[plotDef:d_TkMET_MET_proj]
relPath = TkMET_pt*TMath::Cos(TkMET_phi-MET_Phi)-MET_Pt
xAxis = d_TkMET_MET_proj
nBins = 30
min = -200
max = 100

[plotDef:d_TkMET_MET_proj_rel]
relPath = (MET_Pt-TkMET_pt*TMath::Cos(TkMET_phi-MET_Phi))/MET_Pt
xAxis = (MET_Pt-TkMET_pt*TMath::Cos(TkMET_phi-MET_Phi))/TkMET_pt
nBins = 30
min = -0.5
max = 1.5

[plotDef:METphi]
relPath = MET_Phi
xAxis = #phi(MET)
nBins = 20
min = -3.1416
max = 3.1416

[plotDef:METphi_uncorrected]
relPath = MET_Phi_uncorrected
xAxis = #phi(MET) (no XY)
nBins = 20
min = -3.1416
max = 3.1416

[plotDef:minDphiMETjet]
relPath = Min$(abs(TVector2::Phi_mpi_pi(Jet_phi[hJidx]-MET_Phi))) 
xAxis   = min #||{#Delta#Phi(j, MET)}
nBins   = 40
min     = 0
max     = 4

[plotDef:dPhi_H_MET]
relPath = abs(TVector2::Phi_mpi_pi(H_phi-MET_Phi))
xAxis   = #||{#Delta#Phi(H, MET)}
nBins   = 40
min     = 0
max     = 4

[plotDef:dPhiLepMet]
relPath = dPhiLepMet
xAxis = #Delta #phi(l,MET)
nBins = 40
min = 0.0
max = 3.1416

[plotDef:tkmetphi]
relPath = tkMet_phi
xAxis   = tkMet_phi
nBins   = 63
min     = -3.1416
max     = 3.1416

[plotDef:lpvf]
relPath = -1.0+(Vtype==2)*(1.0+Muon_pt[vLidx[0]]*TMath::Cos(Muon_phi[vLidx[0]]-V_phi)/V_pt)+(Vtype==3)*(1.0+Electron_pt[vLidx[0]]*TMath::Cos(Electron_phi[vLidx[0]]-V_phi)/V_pt)
xAxis   = lpvf 
nBins   = 10
min     = 0
max     = 1
log     = True

[plotDef:mindphilepjet]
relPath = -1.0+(Vtype==2)*(1.0+MinIf$(abs(TVector2::Phi_mpi_pi(Jet_phi-Muon_phi[vLidx[0]])),Jet_Pt>20&&<!General|Jet_tight!>)) + (Vtype==3)*(1.0+3.14159+MinIf$(abs(TVector2::Phi_mpi_pi(Jet_phi-Electron_phi[vLidx[0]])),Jet_Pt>20&&<!General|Jet_tight!>))
xAxis   = mindphilepjet
nBins   = 62
min     = 0
max     = 6.28318531
log     = True

[plotDef:jpms]
relPath = -1.0+(Vtype==2)*(1.0+Sum$(TMath::Sqrt(Jet_Pt)*TMath::Cos(MET_Phi-Jet_phi)*(Jet_Pt>20&&<!General|Jet_tight!>&&abs(TVector2::Phi_mpi_pi(MET_Phi-Jet_phi))<1.57)) + TMath::Sqrt(Muon_pt[vLidx[0]])*TMath::Cos(Muon_phi[vLidx[0]]-MET_Phi)*(abs(TVector2::Phi_mpi_pi(Muon_phi[vLidx[0]]-MET_Phi))<1.57) )
xAxis   = jpms
nBins   = 50
min     = 0
max     = 50

[plotDef:minv3]
relPath = -1.0+(Vtype==2)*(1.0+VHbb::m_inv3(Jet_Pt[hJidx[0]],Jet_eta[hJidx[0]],Jet_phi[hJidx[0]],Jet_mass_nom[hJidx[0]],Jet_Pt[hJidx[1]],Jet_eta[hJidx[1]],Jet_phi[hJidx[1]],Jet_mass_nom[hJidx[1]],Alt$(Muon_pt[vLidx[0]],0),Alt$(Muon_eta[vLidx[0]],0),Alt$(Muon_phi[vLidx[0]],0),Alt$(Muon_mass[vLidx[0]],0)))
xAxis   = minv3 
nBins   = 50
min     = 0
max     = 200


[plotDef:min_dPhi_Jet_MET_pt20_puId4]
relPath = MinIf$(abs(TVector2::Phi_mpi_pi(Jet_phi-MET_Phi)),Jet_pt>20&&(Jet_puId>=4||Jet_Pt>50))
xAxis   = #||{#Delta#phi(Jet, MET)} (p_{T}(Jet) > 20 GeV)
nBins   = 18
min     = -0.3
max     = 3.3

[plotDef:min_dPhi_Jet_MET_pt30_puId4]
relPath = MinIf$(abs(TVector2::Phi_mpi_pi(Jet_phi-MET_Phi)),Jet_pt>30&&(Jet_puId>=4||Jet_Pt>50))
xAxis   = #||{#Delta#phi(Jet, MET)} (p_{T}(Jet) > 30 GeV)
nBins   = 18
min     = -0.3
max     = 3.3

[plotDef:min_dPhi_j12_MET_puId4]
relPath = MinIf$(abs(TVector2::Phi_mpi_pi(Jet_phi[hJidx]-MET_Phi)),(Jet_puId[hJidx]>=4||Jet_Pt[hJidx]>50))
xAxis   = #||{#Delta#phi(j_{1,2}, MET)}
nBins   = 18
min     = -0.3
max     = 3.3

[plotDef:min_dPhi_Jet_MET_pt20_puId7]
relPath = MinIf$(abs(TVector2::Phi_mpi_pi(Jet_phi-MET_Phi)),Jet_pt>20&&(Jet_puId>=7||Jet_Pt>50))
xAxis   = #||{#Delta#phi(Jet, MET)} (p_{T}(Jet) > 20 GeV)
nBins   = 18
min     = -0.3
max     = 3.3

[plotDef:min_dPhi_Jet_MET_pt30_puId7]
relPath = MinIf$(abs(TVector2::Phi_mpi_pi(Jet_phi-MET_Phi)),Jet_pt>30&&(Jet_puId>=7||Jet_Pt>50))
xAxis   = #||{#Delta#phi(Jet, MET)} (p_{T}(Jet) > 30 GeV)
nBins   = 18
min     = -0.3
max     = 3.3

[plotDef:min_dPhi_j12_MET_puId7]
relPath = MinIf$(abs(TVector2::Phi_mpi_pi(Jet_phi[hJidx]-MET_Phi)),(Jet_puId[hJidx]>=7||Jet_Pt[hJidx]>50))
xAxis   = #||{#Delta#phi(j_{1,2}, MET)}
nBins   = 18
min     = -0.3
max     = 3.3

[plotDef:min_MET_MHT]
relPath = min(MET_Pt, MHT_pt)
xAxis   = min(MET, MHT) [GeV]
nBins   = 50
min     = 0
max     = 500

[plotDef:METsig]
relPath = (MET_Pt/TMath::Sqrt(Sum$(Jet_Pt*(Jet_Pt>30&&Jet_puId>0&&Jet_lepFilter)))) 
xAxis   = MET significance
nBins   = 40
min     = 0
max     = 20

[plotDef:METsig_puid]
relPath = (MET_Pt/TMath::Sqrt(Sum$(Jet_Pt*(Jet_Pt>30&&&(Jet_puId>6||Jet_Pt>50)&&Jet_lepFilter)))) 
xAxis   = MET significance
nBins   = 40
min     = 0
max     = 20


[plotDef:METsigAdd]
relPath = (MET_Pt/TMath::Sqrt(Sum$(Jet_Pt*(Jet_Pt>30&&(Jet_puId>6||Jet_Pt>50)&&Jet_lepFilter&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1]))))
xAxis   = MET significance (add jet)
nBins   = 40
min     = 5
max     = 25

[plotDef:nAddJetCloseToMET]
relPath = Sum$(abs(MET_Phi-Jet_phi)<1.57&&Jet_lepFilter&&Jet_Pt>20&&(Jet_puId>6||Jet_Pt>50)&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1])
xAxis   = n add jets close to MET
min     = 0
max     = 5
nBins   = 5

[plotDef:nAddJetFarFromMET]
relPath = Sum$(abs(MET_Phi-Jet_phi)>1.57&&Jet_lepFilter&&Jet_Pt>20&&(Jet_puId>6||Jet_Pt>50)&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1])
xAxis   = n add jets far from MET
min     = 0
max     = 5
nBins   = 5

[plotDef:nAddJetTransverse]
relPath = Sum$(abs(MET_Phi-Jet_phi)>0.784&&abs(MET_Phi-Jet_phi)<2.356&&Jet_lepFilter&&Jet_Pt>20&&(Jet_puId>6||Jet_Pt>50)&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1])
xAxis   = n add jets far from MET
min     = 0
max     = 5
nBins   = 5

[plotDef:nAddJetVeryCloseToMET]
relPath = Sum$(abs(MET_Phi-Jet_phi)<0.784&&Jet_lepFilter&&Jet_Pt>20&&(Jet_puId>6||Jet_Pt>50)&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1])
xAxis   = n add jets close to MET
min     = 0
max     = 5
nBins   = 5

[plotDef:nAddJetVeryFarFromMET]
relPath = Sum$(abs(MET_Phi-Jet_phi)>2.356&&Jet_lepFilter&&Jet_Pt>20&&(Jet_puId>6||Jet_Pt>50)&&Iteration$!=hJidx[0]&&Iteration$!=hJidx[1])
xAxis   = n add jets far from MET
min     = 0
max     = 5
nBins   = 5

[plotDef:deltaPhiVH_0lep]
relPath = abs(TVector2::Phi_mpi_pi(H_phi-V_phi))
xAxis = #||{#phi_{V} - #phi_{H}}
nBins = 32
min = 0
max = 3.2

[plotDef:addJetMaxBtag_0lep]
relPath = MaxIf$(Jet_btagDeepB,Jet_Pt>30&&abs(Jet_eta)<2.4&&<!General|Jet_tight!>&&<!General|Jet_additional!>)
xAxis = add jet max DeepCSV
nBins = 25
min = 0
max = 1.0

[plotDef:addJetMaxPt_0lep]
relPath = MaxIf$(Jet_Pt,Jet_Pt>30&&abs(Jet_eta)<2.4&&<!General|Jet_tight!>&&<!General|Jet_additional!>)
xAxis = add jet max pt
nBins = 40
min = 0
max = 400

[plotDef:minDeltaPhiJetMET_0lep]
relPath = MinIf$(abs(TVector2::Phi_mpi_pi(Jet_phi-MET_Phi)),Jet_Pt>30&&abs(Jet_eta)<2.4&&<!General|Jet_tight!>&&<!General|Jet_additional!>)
xAxis = min #Delta #phi(j,MET)
nBins = 32
min = 0.0
max = 3.1416

[plotDef:addJetMaxBtag_0lep_addJetExists]
relPath = -99.0+MaxIf$(99.0+Jet_btagDeepB,Jet_Pt>30&&abs(Jet_eta)<2.4&&<!General|Jet_tight!>&&<!General|Jet_additional!>)
xAxis = add jet max DeepCSV
nBins = 25
min = 0
max = 1.0

[plotDef:addJetMaxBtag_WP_0lep_addJetExists]
relPath = -99.0+MaxIf$(99.0+(Jet_btagDeepB>0.1522)+(Jet_btagDeepB>0.4941)+(Jet_btagDeepB>0.8001),Jet_Pt>30&&abs(Jet_eta)<2.4&&<!General|Jet_tight!>&&<!General|Jet_additional!>)
xAxis = add jet max DeepCSV
nBins = 4
min = -0.5
max = 3.5

[plotDef:addJetMaxPt_0lep_addJetExists]
relPath = -99.0+MaxIf$(99.0+Jet_Pt,Jet_Pt>30&&abs(Jet_eta)<2.4&&<!General|Jet_tight!>&&<!General|Jet_additional!>)
xAxis = add jet max pt
nBins = 40
min = 0
max = 400

[plotDef:minDeltaPhiJetMET_0lep_addJetExists]
relPath = -99.0+MinIf$(99.0+abs(TVector2::Phi_mpi_pi(Jet_phi-MET_Phi)),Jet_Pt>30&&abs(Jet_eta)<2.4&&<!General|Jet_tight!>&&<!General|Jet_additional!>)
xAxis = min #Delta #phi(j,MET)
nBins = 32
min = 0.0
max = 3.1416

# ------------------------------------------------------------------------------------------------------------------------------------------------------
# Higgs 
# ------------------------------------------------------------------------------------------------------------------------------------------------------
[plotDef:Hmass]
relPath = -99+(hJidx[0]>-1)*(99+H_mass)
xAxis   = m(jj) [GeV]
nBins   = 25 
min     = 0
max     = 250
#blind   = True

[plotDef:Hmass50bins]
relPath = -99+(hJidx[0]>-1)*(99+H_mass)
xAxis   = m(jj) [GeV]
nBins   = 50
min     = 0
max     = 250
#blind   = True

[plotDef:Hmass_50_200]
relPath = -99+(hJidx[0]>-1)*(99+H_mass)
xAxis   = m(jj) [GeV]
nBins   = 15 
min     = 50
max     = 200
blind   = True

[plotDef:Hmass_SR]
relPath = -99+(hJidx[0]>-1)*(99+H_mass)
xAxis   = m(jj) [GeV]
nBins   = 25 
min     = 90
max     = 150
blind   = True

[plotDef:Hmass_0to500]
relPath = -99+(hJidx[0]>-1)*(99+H_mass)
xAxis   = m(jj) [GeV]
nBins   = 50 
min     = 0
max     = 500
blind   = True

[plotDef:Hmass_0to900]
relPath = -99+(hJidx[0]>-1)*(99+H_mass)
xAxis   = m(jj) [GeV]
nBins   = 90 
min     = 0
max     = 900
blind   = True


[plotDef:Hmass80to160]
relPath = -99+(hJidx[0]>-1)*(99+H_mass)
xAxis   = m(jj) [GeV]
nBins   = 16 
min     = 80
max     = 160
blind  = True

[plotDef:Hmass_noFSR]
relPath = -99+(hJidx[0]>-1)*(99+H_mass_noFSR)
xAxis   = m_{jj} [GeV]
nBins   = 25
min     = 0
max     = 250

[plotDef:Hpt]
relPath = -99+(hJidx[0]>-1)*(99+H_pt)
xAxis   = p_{T}(jj) [GeV]
nBins   = 40
min     = 0
max     = 400

[plotDef:Hpt_800]
relPath = -99+(hJidx[0]>-1)*(99+H_pt)
xAxis   = p_{T}(jj) [GeV]
nBins   = 40
min     = 0
max     = 800


[plotDef:Hpt_noFSR]
relPath = H_pt_noFSR
xAxis   = p_{T}(jj) [GeV]
nBins   = 40
min     = 0
max     = 400


[plotDef:Heta]
relPath = -99+(hJidx[0]>-1)*(99+H_eta)
xAxis   = H_{#eta}
nBins   = 25
min     = -5
max     = 5

[plotDef:Hphi]
relPath = -99+(hJidx[0]>-1)*(99+H_phi)
xAxis   = H_{#phi}
nBins   = 20
min     = -3.1416
max     = 3.1416

[plotDef:nFSRrecovered]
relPath = nFSRrecovered
xAxis   = nFSRrecovered
nBins   = 4
min     = 0
max     = 4

# ------------------------------------------------------------------------------------------------------------------------------------------------------
# Vector Boson
# ------------------------------------------------------------------------------------------------------------------------------------------------------
[plotDef:Vpt]
relPath = V_pt
xAxis   = p_{T} (V) [GeV]
nBins   = 40
min     = 0
max     = 600

[plotDef:Vpt250_300_400]
relPath = V_pt
xAxis   = p_{T} (V) [GeV]
nBins   = 3
min     = 250
max     = 600
binList = [250.0,300.0,400.0,600.0]

[plotDef:Vpt250_300_400_600_800]
relPath = V_pt
xAxis   = p_{T} (V) [GeV]
nBins   = 5
min     = 250
max     = 1000
binList = [250.0,300.0,400.0,600.0,800.0,1000.0]
log     = True

[plotDef:Vpt250_300_400_600_800_1000]
relPath = V_pt
xAxis   = p_{T} (V) [GeV]
nBins   = 6
min     = 250
max     = 2000
binList = [250.0,300.0,400.0,600.0,800.0,1000.0,2000.0]
log     = True


[plotDef:VptNoNLOweight]
relPath = V_pt
xAxis   = p_{T} (V) [GeV] (no NLO weight)
nBins   = 40
min     = 0
max     = 600
weight  = <!Weights|weightF!>/<!Weights|weightNLO!>
additionalText = "no NLO weight"

[plotDef:VptLog]
relPath = V_pt
xAxis   = p_{T} (V) [GeV]
nBins   = 40
min     = 0
max     = 800
log     = True

[plotDef:VptLogNoNLOweight]
relPath = V_pt
xAxis   = p_{T} (V) [GeV] (no NLO weight)
nBins   = 40
min     = 0
max     = 800
log     = True
weight  = <!Weights|weightF!>/<!Weights|weightNLO!>
additionalText = "no NLO weight"

[plotDef:Veta]
relPath = V_eta
xAxis   = V_{#eta}
nBins   = 25
min     = -5
max     = 5

[plotDef:Vphi]
relPath = V_phi
xAxis   = #phi(V)
nBins   = 32
min     = -3.2
max     = 3.2

[plotDef:Vmass]
relPath = V_mass
xAxis   = m_{l^{+}l^{-}} [GeV]
nBins   = 20
min     = 75
max     = 105

[plotDef:Vmass_ttbar]
relPath = <!plotDef:Vmass|relPath!> 
xAxis   = <!plotDef:Vmass|xAxis!> 
nBins   = 40
min     = 0
max     = 200

[plotDef:Vmt]
relPath = V_mt
xAxis  = transverse V_{mass} [GeV]
nBins = 25
min = 0
max = 250

[plotDef:Vmt_ext]
relPath = V_mt
xAxis  = transverse V_{mass} [GeV]
nBins = 25
min = 0
max = 250

# ------------------------------------------------------------------------------------------------------------------------------------------------------
# top 
# ------------------------------------------------------------------------------------------------------------------------------------------------------
[plotDef:top_mass_reco_neutrino_solver_branch]
relPath = top_mass_reco_neutrino_solver_branch
xAxis   = top mass reco branch
nBins   = 8
min     = 0
max     = 8

[plotDef:top_mass_reco_neutrino_E]
relPath = top_mass_reco_neutrino_E
xAxis   = neutrino energy (for top mass)
nBins   = 100
min     = 0
max     = 500
log     = True

[plotDef:top_mass_reco_neutrino_pt]
relPath = TMath::Sqrt(top_mass_reco_neutrino_px*top_mass_reco_neutrino_px+top_mass_reco_neutrino_py*top_mass_reco_neutrino_py)
xAxis   = neutrino pt (for top mass)
nBins   = 100
min     = 0
max     = 500
log     = True

[plotDef:top_mass_reco_neutrino_pz]
relPath = top_mass_reco_neutrino_pz
xAxis   = neutrino pt (for top mass)
nBins   = 100
min     = -200
max     = 200
log     = True


# ------------------------------------------------------------------------------------------------------------------------------------------------------
# VH system 
# ------------------------------------------------------------------------------------------------------------------------------------------------------

[plotDef:VHpt]
relPath = VHbb::twoFVpt(H_pt,H_eta,H_phi,H_mass,MET_Pt,0,MET_Phi,0) 
xAxis = VHpt 
nBins = 40
min = 0
max = 400 

[plotDef:VHmass]
relPath = VHbb::twoFVmass(H_pt,H_eta,H_phi,H_mass,MET_Pt,0,MET_Phi,0) 
xAxis = VHmass 
nBins = 20
min = 0
max = 200 


[plotDef:deltaPhiVH]
relPath = abs(VHbb::deltaPhi(H_phi,V_phi))
xAxis = #||{#phi_{V} - #phi_{H}}
nBins = 32
min = 0
max = 3.1416

[plotDef:deltaPhiVH_1lep]
relPath = abs(TVector2::Phi_mpi_pi(V_phi-H_phi))
xAxis = #||{#phi_{V} - #phi_{H}}
nBins = 32
min = 0
max = 3.1416


[plotDef:deltaEtaVH]
relPath = abs(H_eta - V_eta)
xAxis = #||{#eta_{V} - reg. #eta_{H}}
nBins = 30
min = 0
max = 5

[plotDef:deltaRVH]
relPath = VHbb::deltaR(H_eta,H_phi,V_eta,V_phi)
xAxis = #Delta R(V,H)
nBins = 40
min = 0.0
max = 6.0

[plotDef:ptBalance]
relPath = H_pt/V_pt
xAxis = p_{T} balance (p_{T}(H)/p_{T}(V))
nBins = 50
min = 0.0
max = 2.0

[plotDef:invPtBalance]
relPath = V_pt/H_pt
xAxis = p_{T}(V)/p_{T}(H)
nBins = 50
min = 0.0
max = 2.0

[plotDef:MET_H_ratio]
relPath = -99+(hJidx[0]>-1)*(99+MET_Pt/H_pt)
xAxis   = MET/p_{T}(jj)
nBins   = 40
min     = 0
max     = 2

# ------------------------------------------------------------------------------------------------------------------------------------------------------
# pileup related 
# ------------------------------------------------------------------------------------------------------------------------------------------------------
[plotDef:nVertices]
relPath = PV_npvs
xAxis   = #Vertices
nBins   = 60
min     = 0
max     = 60

[plotDef:nPV]
relPath = PV_npvs
xAxis   = #Vertices
nBins   = 60
min     = 0
max     = 60

[plotDef:rho]
relPath = fixedGridRhoFastjetAll
xAxis   = rho
nBins   = 60
min     = 0
max     = 60


# ------------------------------------------------------------------------------------------------------------------------------------------------------
# weights
# ------------------------------------------------------------------------------------------------------------------------------------------------------
[plotDef:genWeight]
xAxis = genWeight
relPath = genWeight
nBins = 100
min = 0
max = 0.4
weightF = 1.0

[plotDef:puWeight]
relPath = puWeight
xAxis   = PU weight 
nBins   = 50
min     = 0.5
max     = 2.0
weight  = genWeight

[plotDef:EWKsignalWeight]
relPath = EWKwSIG[0] 
xAxis   = EWK signal weight 
nBins   = 50
min     = 0.6
max     = 1.2
weight  = genWeight

[plotDef:METweight]
relPath = weight_mettrigSF 
xAxis   = MET trigger SF 
nBins   = 120
min     = 0.0
max     = 1.2
weight  = genWeight

[plotDef:bTagWeight]
relPath = bTagWeightDeepCSV 
xAxis   = btag weight 
nBins   = 200
min     = 0.0
max     = 2.0
weight  = genWeight 

[plotDef:EWKweight]
relPath = EWKw[0] 
xAxis   = EWK weight
nBins   = 50
min     = 0.6
max     = 1.2
weight  = genWeight 

[plotDef:NLOweight]
relPath = <!Weights|weightNLO!>
xAxis   = LO to NLO weight (<!Weights|weightNLO!>)
nBins   = 100
min     = 0.0
max     = 2.0
weight  = genWeight

[plotDef:NLOweight_2016]
relPath = weightLOtoNLO_2016
xAxis   = LO to NLO weight (2016)
nBins   = 50
min     = 0.6
max     = 1.2
weight  = genWeight

[plotDef:weightLOtoNLO_LHEVptV2]
relPath = weightLOtoNLO_LHEVptV2
xAxis   = weightLOtoNLO_LHEVptV2
nBins   = 50
min     = 0.5
max     = 1.5
weight  = genWeight

[plotDef:weightLOtoNLO_LHEVptV3]
relPath = weightLOtoNLO_LHEVptV3
xAxis   = weightLOtoNLO_LHEVptV3
nBins   = 50
min     = 0.5
max     = 1.5
weight  = genWeight

[plotDef:fitcorr]
relPath = FitCorr[0]
xAxis   = linear Vpt fit corr
nBins   = 50
min     = 0.4
max     = 1.4
weight  = genWeight

[plotDef:weightJetPUID]
relPath = weightJetPUID
xAxis   = weightJetPUID
nBins   = 50
min     = 0.4
max     = 1.4
weight  = genWeight

[plotDef:PrefireWeight]
relPath = PrefireWeight 
xAxis   = PrefireWeight
nBins   = 50
min     = 0.4
max     = 1.4
weight  = genWeight

# for stitching of b-enriched samples
[plotDef:ZJB]
xAxis = Nb=GenB=0 | Nb=0,GenB>0 | Nb>0 
relPath =  0*(LHE_Nb==0&&nGenStatus2bHad==0)+1*((LHE_Nb==0&&nGenStatus2bHad>0))+2*(LHE_Nb>0)
nBins = 3
min = 0
max = 3
drawOption = HIST;TEXT0

[plotDef:LHE_VPT_TEXT]
xAxis = LHE_Vpt
relPath = LHE_Vpt
nBins = 10 
min = 0
max = 500
drawOption = HIST;TEXT0

[plotDef:LHE_HT_TEXT]
xAxis = LHE_HT
relPath = LHE_HT
nBins = 10 
min = 0
max = 500
drawOption = HIST;TEXT0



#----- Boosted analysis -----#

[plotDef:FatJet_Pt]
relPath = FatJet_Pt[Hbb_fjidx]
xAxis = FatJet p_{T} [GeV]
nBins = 50
min = 0
max = 800

[plotDef:FatJet_mSD]
relPath = FatJet_Msoftdrop[Hbb_fjidx]
xAxis   = FatJet mSD [GeV]
nBins   = 50
min     = 0
max     = 300

[plotDef:FatJet_mSD_corr]
relPath = isData*FatJet_Msoftdrop[Hbb_fjidx]+(1-isData)*FatJet_Msoftdrop[Hbb_fjidx]/MinIf$(FatJet_msoftdrop_corr_PUPPI[Hbb_fjidx],!isData)
xAxis   = FatJet mSD [GeV]
nBins   = 50
min     = 0
max     = 300


[plotDef:FatJet_mSD_closestToMuon]
relPath = Alt$(FatJet_Msoftdrop[0]*(VHbb::deltaR(FatJet_eta[0],FatJet_phi[0],Muon_eta[vLidx[0]],Muon_phi[vLidx[0]])==MaxIf$(VHbb::deltaR(FatJet_eta,FatJet_phi,Muon_eta[vLidx[0]],Muon_phi[vLidx[0]]),FatJet_Msoftdrop>120)),0)+Alt$(FatJet_Msoftdrop[1]*(VHbb::deltaR(FatJet_eta[1],FatJet_phi[1],Muon_eta[vLidx[0]],Muon_phi[vLidx[0]])==MaxIf$(VHbb::deltaR(FatJet_eta,FatJet_phi,Muon_eta[vLidx[0]],Muon_phi[vLidx[0]]),FatJet_Msoftdrop>120)),0)+Alt$(FatJet_Msoftdrop[2]*(VHbb::deltaR(FatJet_eta[2],FatJet_phi[2],Muon_eta[vLidx[0]],Muon_phi[vLidx[0]])==MaxIf$(VHbb::deltaR(FatJet_eta,FatJet_phi,Muon_eta[vLidx[0]],Muon_phi[vLidx[0]]),FatJet_Msoftdrop>120)),0)+Alt$(FatJet_Msoftdrop[3]*(VHbb::deltaR(FatJet_eta[3],FatJet_phi[3],Muon_eta[vLidx[0]],Muon_phi[vLidx[0]])==MaxIf$(VHbb::deltaR(FatJet_eta,FatJet_phi,Muon_eta[vLidx[0]],Muon_phi[vLidx[0]]),FatJet_Msoftdrop>120)),0) 
xAxis   = FatJet mSD [GeV] closest to muon
nBins   = 50
min     = 0
max     = 300


[plotDef:DeepAK8_bbVSlight]
relPath = FatJet_deepTagMD_bbvsLight[Hbb_fjidx]
xAxis   = Deep AK8 - bb vs light
nBins   = 40
min     = 0
max     = 1

[plotDef:DeepAK8_bbVSlight_high]
relPath = FatJet_deepTagMD_bbvsLight[Hbb_fjidx]
xAxis   = Deep AK8 - bb vs light
nBins   = 3
min     = 0.8
max     = 1

[plotDef:DeepAK8_bbVSlight_10bins]
relPath = FatJet_deepTagMD_bbvsLight[Hbb_fjidx]
xAxis   = Deep AK8 - bb vs light
nBins   = 10
min     = 0.0
max     = 1.0

[plotDef:DeepAK8_bbVSlight_final]
relPath = FatJet_deepTagMD_bbvsLight[Hbb_fjidx]
xAxis   = Deep AK8 - bb vs light
binList = [0.0,0.4,0.8,0.97,1.0]

[plotDef:DeepAK8_bbVSlight_final_high]
relPath = FatJet_deepTagMD_bbvsLight[Hbb_fjidx]
xAxis   = Deep AK8 - bb vs light
binList = [0.75,0.8,0.97,1.0]



[plotDef:DeepAK8_bbVST]
relPath = 1/(1+(FatJet_deepTagMD_TvsQCD[Hbb_fjidx]/FatJet_deepTagMD_HbbvsQCD[Hbb_fjidx])*(1-FatJet_deepTagMD_HbbvsQCD[Hbb_fjidx])/(1-FatJet_deepTagMD_TvsQCD[Hbb_fjidx]))
xAxis   = Deep AK8 - bb vs T
nBins   = 20
min     = 0 
max     = 1


[plotDef:DeepAK8_bbVST]
relPath = 1/(1+(FatJet_deepTagMD_TvsQCD[Hbb_fjidx]/FatJet_deepTagMD_HbbvsQCD[Hbb_fjidx])*(1-FatJet_deepTagMD_HbbvsQCD[Hbb_fjidx])/(1-FatJet_deepTagMD_TvsQCD[Hbb_fjidx]))
xAxis   = Deep AK8 - bb vs T
nBins   = 20
min     = 0 
max     = 1

[plotDef:FatJet_lepFilter]
relPath = FatJet_lepFilter[Hbb_fjidx]
xAxis = FatJet lepton filter
nBins = 2
min = 0
max = 2
drawOptionData = PE;TEXT0

[plotDef:FatJet_deltaR_electrons]
relPath = isWenu*(VHbb::deltaR(FatJet_eta[Hbb_fjidx],FatJet_phi[Hbb_fjidx],Electron_eta[vLidx[0]],Electron_phi[vLidx[0]]))-100*isWmunu
xAxis = #Delta R(fat jet, electron) 
nBins = 60
min = 0
max = 6

[plotDef:FatJet_deltaR_muons]
relPath = isWmunu*(VHbb::deltaR(FatJet_eta[Hbb_fjidx],FatJet_phi[Hbb_fjidx],Muon_eta[vLidx[0]],Muon_phi[vLidx[0]]))-100*isWenu
xAxis = #Delta R(fat jet, muon) 
nBins = 60
min = 0
max = 6

[plotDef:FatJet_deltaR_electrons_Msd]
relPath = FatJet_Msoftdrop[Hbb_fjidx]:isWenu*(VHbb::deltaR(FatJet_eta[Hbb_fjidx],FatJet_phi[Hbb_fjidx],Electron_eta[vLidx[0]],Electron_phi[vLidx[0]]))-100*isWmunu
xAxis = #Delta R(fat jet, electron)
yAxis = softdrop mass
nBins = 60
min = 0
max = 6
nBinsY = 60
minY = 90
maxY = 150
draw = MC

[plotDef:FatJet_Msoftdrop]
relPath = FatJet_Msoftdrop[Hbb_fjidx]
xAxis = softdrop mass 
nBins = 50
min = 0
max = 250

[plotDef:FatJet_Msoftdrop_fewBins]
relPath = FatJet_Msoftdrop[Hbb_fjidx]
xAxis = softdrop mass 
nBins = 10
min = 30
max = 230

[plotDef:deltaPhiFatJetV_0lep]
relPath = abs(TVector2::Phi_mpi_pi(MET_Phi-FatJet_phi[Hbb_fjidx]))
xAxis = #Delta #phi (fat jet, V)
nBins = 50
min = 0
max = 3.1416

[plotDef:deltaPhiFatJetV]
relPath = abs(TVector2::Phi_mpi_pi(V_phi-FatJet_phi[Hbb_fjidx]))
xAxis = #Delta #phi (fat jet, V)
nBins = 50
min = 0
max = 3.1416


[plotDef:tau21]
relPath = FatJet_tau2[Hbb_fjidx]/FatJet_tau1[Hbb_fjidx]
xAxis   = tau_{21}
nBins   = 20
#nBins   = 100
min     = 0
max     = 1

[plotDef:tau32]
relPath = FatJet_tau3[Hbb_fjidx]/FatJet_tau2[Hbb_fjidx]
xAxis   = tau_{32}
nBins   = 20 
min     = 0
max     = 1


[plotDef:PtRatioBoost]
relPath = FatJet_Pt[Hbb_fjidx]/V_pt
xAxis   = jj/W P_{T} Bal
nBins   = 30
min     = 0
max     = 2

[plotDef:nFatJet]
relPath = nFatJet 
xAxis   = nFatJet
nBins   = 6
min     = 0
max     = 6

[plotDef:maxDeltaPhiJetFatJet]
relPath = MaxIf$(abs(TVector2::Phi_mpi_pi(FatJet_phi[Hbb_fjidx]-Jet_phi)),abs(Jet_eta)<2.4&&Jet_Pt>30&&<!General|Jet_tight!>)
xAxis   = max #Delta #phi(fj,j>30)
nBins   = 40
min     = 0
max     = 3.1416

[plotDef:minDeltaPhiJetFatJet]
relPath = MinIf$(abs(TVector2::Phi_mpi_pi(FatJet_phi[Hbb_fjidx]-Jet_phi)),abs(Jet_eta)<2.4&&Jet_Pt>30&&<!General|Jet_tight!>)
xAxis   = min #Delta #phi(fj,j>30)
nBins   = 40
min     = 0
max     = 3.1416
log     = True

[plotDef:minDeltaPhiAddJetFatJet]
relPath = MinIf$(abs(TVector2::Phi_mpi_pi(FatJet_phi[Hbb_fjidx]-Jet_phi)),VHbb::deltaR(FatJet_eta[Hbb_fjidx],FatJet_phi[Hbb_fjidx],Jet_eta,Jet_phi)>0.8&&abs(Jet_eta)<2.4&&Jet_Pt>30&&<!General|Jet_tight!>)
xAxis   = min #Delta #phi(fj,add. j>30)
nBins   = 40
min     = 0
max     = 3.1416
log     = True

[plotDef:nAddBJetsBoosted]
relPath = Sum$(VHbb::deltaR(FatJet_eta[Hbb_fjidx],FatJet_phi[Hbb_fjidx],Jet_eta,Jet_phi)> 0.8 && <!General|Jet_btag_DeepCSV!> > <!General|btagWP_Medium_DeepCSV!> && Jet_lepFilter>0 && Jet_PtReg>25 && fabs(Jet_eta)<2.5)
xAxis = additional AK4 b-tagged jets
nBins = 5
min = 0
max = 5

[plotDef:nAddJetsBoosted]
relPath = Sum$(VHbb::deltaR(FatJet_eta[Hbb_fjidx],FatJet_phi[Hbb_fjidx],Jet_eta,Jet_phi)> 1.6 && Jet_lepFilter>0 && Jet_Pt>25 && fabs(Jet_eta)<2.5 && <!General|Jet_tight!>)
xAxis = additional AK4 jets
nBins = 8
min = 0
max = 8

[plotDef:BDT_Wlv_BOOSTFinal_wdB]
relPath = BDT_Wlv_BOOSTFinal_wdB.Nominal
xAxis   = BDT Output
nBins   = 25 
min     = -1
max     = 1
;log     = True
log     = False 

[plotDef:BDT_Wlv_BOOSTFinal_nodB]
relPath = BDT_Wlv_BOOSTFinal_nodB.Nominal
xAxis   = BDT Output
nBins   = 25 
min     = -1
max     = 1
;log     = True
log     = False 

[plotDef:bHadronsDeltaR]
relPath = -100.0+((nGenBs==2)*(100.0+VHbb::deltaR(GenBs_eta[0],GenBs_phi[0],GenBs_eta[1],GenBs_phi[1])))
xAxis = #Delta R(b-hadrons) (for nBhadrons = 2)
nBins = 60
min   = 0
max   = 6

[plotDef:bHadronsDeltaRfractions]
relPath = -100.0+((nGenBs==2)*(100.0+VHbb::deltaR(GenBs_eta[0],GenBs_phi[0],GenBs_eta[1],GenBs_phi[1])))
xAxis = #Delta R(b-hadrons) (for nBhadrons = 2)
nBins = 60
min   = 0
max   = 6
fractions = True

[plotDef:bHadronsDeltaEta]
relPath = -100.0+((nGenBs==2)*(100.0+abs(GenBs_eta[0]-GenBs_eta[1])))
xAxis = #Delta eta(b-hadrons) (for nBhadrons = 2)
nBins = 50
min   = 0
max   = 5

[plotDef:flavor2D_nGenJetHadronFlav5_nGenBsEta2p4]
relPath = Sum$(GenJet_pt>25 && abs(GenJet_eta)<2.4 && GenJet_hadronFlavour==5):Sum$(abs(GenBs_eta)<2.4)
xAxis   = n gen B eta < 2.4
yAxis   = n gen jets hadronFlavour==5, eta<2.4, pt>25
drawOption = colz text
draw = MC
nBins = 6
min = -0.5
max = 5.5
nBinsY = 6
minY = -0.5
maxY = 5.5

[plotDef:nMuonsInsideFatJet]
relPath = Sum$(VHbb::deltaR(FatJet_eta[Hbb_fjidx],FatJet_phi[Hbb_fjidx],Muon_eta,Muon_phi)<0.8&&Muon_pt>20.0)
xAxis = muons pt>20 inside FatJet
nBins = 5
min   = 0
max   = 5

[plotDef:nElectronsInsideFatJet]
relPath = Sum$(VHbb::deltaR(FatJet_eta[Hbb_fjidx],FatJet_phi[Hbb_fjidx],Electron_eta,Electron_phi)<0.8&&Electron_pt>20.0)
xAxis = electrons pt>20 inside FatJet
nBins = 5
min   = 0
max   = 5

[plotDef:htMuonsInsideFatJet]
relPath = Sum$(Muon_pt*(VHbb::deltaR(FatJet_eta[Hbb_fjidx],FatJet_phi[Hbb_fjidx],Muon_eta,Muon_phi)<0.8&&Muon_pt>20.0))
xAxis = muons pt>20 inside FatJet scalar pt sum
nBins = 50
min   = 5
max   = 255

[plotDef:htElectronsInsideFatJet]
relPath = Sum$(Electron_pt*(VHbb::deltaR(FatJet_eta[Hbb_fjidx],FatJet_phi[Hbb_fjidx],Electron_eta,Electron_phi)<0.8&&Electron_pt>20.0))
xAxis = electrons pt>20 inside FatJet scalar pt sum
nBins = 50
min   = 5
max   = 255



[plotDef:nD]
relPath = (Sum$(GenBs_pt>5&&abs(GenBs_eta)<2.6)>1)+(Sum$(GenBs_pt>25)>1&&Sum$(GenBs_pt>5&&abs(GenBs_eta)<2.6)<2)*2+(Sum$(GenBs_pt>5)>1&&Sum$(GenBs_pt>25)<2&&Sum$(GenBs_pt>5&&abs(GenBs_eta)<2.6)<2)*3 
xAxis = nd
nBins = 4
min = 0
max = 4

[plotDef:btagWP2D]
relPath = 2*(<!General|Jet_btag!>[<!General|btagidx0!>]><!General|btagWP_Tight!>)+(<!General|Jet_btag!>[<!General|btagidx1!>]><!General|btagWP_Medium!>)+(<!General|Jet_btag!>[<!General|btagidx1!>]><!General|btagWP_Tight!>) 
xAxis = <!General|btagMethod!> WPs
nBins = 5
min = 0
max = 5
postproc = for i,j in enumerate([" ","ML"," ","MM"," ","TL"," ","TM"," ","TT"," "],1): self.ratioPlot.GetXaxis().ChangeLabel(i,-1,-1,-1,-1,-1,j)


#----- post-fit plots -----#

[plotDef:postfitDNN]
relPath = 1
xAxis   = DNN bin
nBins   = 15
min     = 0
max     = 15
log     = True

[plotDef:postfitMjj]
relPath = 1
xAxis   = m_{jj} 
nBins   = 20
min     = 60
max     = 160
log     = False

[plotDef:postfitNormalization]
relPath = 1
xAxis   = normalization
nBins   = 2
min     = 0
max     = 2

[plotDef:postfitDeepCSV2]
relPath = 1
xAxis   = min DeepCSV bin
nBins   = 2
min     = 0
max     = 2

[plotDef:postfitCRDNN]
relPath = None 
xAxis   = CRDNN
nBins   = 5
min     = 0
max     = 5
postproc = <!Plot_general|postproc_HFDNN!>

[plotDef:postfitCRDNN_SIG]
relPath = None
xAxis   = DNN bin
nBins   = 15
min     = 0
max     = 15

[plotDef:postfitCRDNN_BKG]
relPath = None
xAxis   = Multi-class DNN bin
nBins   = 50
min     = 0
max     = 50

[plotDef:postfitCRDNN_high_BKG]
relPath = None
xAxis   = Multi-class DNN bin
nBins   = 21
min     = 0
max     = 21
log     = True

[plotDef:postfitCRDNN_med_BKG]
relPath = None
xAxis   = Multi-class DNN bin
nBins   = 14
min     = 0
max     = 14
log     = True

[plotDef:postfitDeepAK8high]
xAxis   = DeepAK8
binList = [0.8,0.97,1.0]

[plotDef:postfitDeepAK8low]
xAxis   = DeepAK8
binList = [0.0,0.4,0.8]

[plotDef:postfitVpt_med]
xAxis   = p_{T} (V) [GeV]
binList = [150.0,200.0,250.0]

[plotDef:postfitVpt_high]
xAxis   = p_{T} (V) [GeV]
binList = [250.0,300.0,400.0,2000.0] 
